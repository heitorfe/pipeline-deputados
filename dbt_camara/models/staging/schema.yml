version: 2

sources:
  - name: camara_raw
    schema: raw
    tables:
      - name: deputados_historico
        description: "Historical and current data of deputados from CÃ¢mara API"
        columns:
          - name: id
            description: "Unique identifier for deputado"
            data_tests:
              - not_null
          - name: nome
            description: "Name of the deputado"
          - name: partido
            description: "Political party"
          - name: uf
            description: "State abbreviation"
          - name: url_foto
            description: "Photo URL"
          - name: legislatura_id
            description: "Legislature period ID"
            data_tests:
              - not_null
          - name: is_current
            description: "Flag indicating if this is the current mandate"

      - name: despesas
        description: "Raw expenses data from deputados"
        columns:
          - name: deputado_id
            description: "Foreign key to deputados"
            data_tests:
              - not_null
          - name: cod_documento
            description: "Document code"
            data_tests:
              - not_null
          - name: valor_documento
            description: "Document value"
          - name: valor_liquido
            description: "Net value"
          - name: valor_glosa
            description: "Gloss value"

models:
  - name: stg_deputados
    description: "Staging table for deputados with historical data and cleansing"
    columns:
      - name: deputado_id
        description: "Unique identifier for deputado"
        data_tests:
          - not_null
      - name: sk_deputado_historico
        description: "Surrogate key for historical records (deputado + legislatura + partido)"
        data_tests:
          - not_null
          - unique

  - name: stg_despesas
    description: "Staging table for despesas with data cleansing"
    columns:
      - name: deputado_id
        description: "Foreign key to deputados"
        data_tests:
          - not_null
      - name: cod_documento
        description: "Document code"
        data_tests:
          - not_null
